<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLUJO CALOR - Tu Sistema Completo de Automatización | Math AI</title>
    <meta name="description" content="Acceso completo al sistema FLUJO CALOR: plantilla N8N, prompts de IA, diagramas y checklist de implementación.">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://app.cal.com https://cal.com; 
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                   font-src 'self' https://fonts.gstatic.com; 
                   img-src 'self' https://res.cloudinary.com data:; 
                   connect-src 'self' https://www.google-analytics.com https://analytics.google.com https://app.cal.com; 
                   frame-src https://cal.com https://app.cal.com; 
                   object-src 'none'; 
                   base-uri 'self';">
    
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <!-- Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="FLUJO CALOR - Tu Sistema Completo de Automatización">
    <meta property="og:description" content="Acceso completo al sistema FLUJO CALOR: plantilla N8N, prompts de IA, diagramas y checklist de implementación.">
    <meta property="og:image" content="https://res.cloudinary.com/dfuya0vrl/image/upload/v1746402411/logo_sxdfzb.png">
    <meta property="og:url" content="https://mathai.agency/flujo-calor-contenido.html">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="FLUJO CALOR - Sistema Completo de Automatización">
    <meta name="twitter:description" content="Plantilla N8N, prompts de IA, diagramas y checklist completo">
    <meta name="twitter:image" content="https://res.cloudinary.com/dfuya0vrl/image/upload/v1746402411/logo_sxdfzb.png">
    
    <!-- SEO -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#ffffff">
    <link rel="canonical" href="https://mathai.agency/flujo-calor-contenido.html">
    
    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LWV7YB90M5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-LWV7YB90M5');
    </script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Work+Sans:wght@400;500&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- CSS PROFESIONAL OPTIMIZADO -->
    <style>
        /* ============= RESET Y VARIABLES ============= */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            /* PALETA PROFESIONAL OSCURA - CONSISTENTE CON PÁGINA DE CAPTURA */
            --bg-color: #0a0f1f;
            --bg-primary: #0a0f1f;
            --bg-secondary: #121a30;
            --bg-accent: #1a2332;
            
            /* TEXTOS SOBRE FONDO OSCURO */
            --text-light: #FFFFFF;
            --text-primary: #FFFFFF;
            --text-medium: #adb5bd;
            --text-secondary: #adb5bd;
            --text-muted: #94a3b8;
            
            /* MARCA */
            --primary-orange: #FF6B00;
            --orange-primary: #FF6B00;
            --flujo-primary: #FF4500;
            --orange-gradient: linear-gradient(135deg, #FF6B00 0%, #FF4500 100%);
            
            /* BORDES Y SOMBRAS PARA FONDO OSCURO */
            --border-color: #2a3652;
            --border-light: #2a3652;
            --border-medium: #334155;
            --shadow-sm: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 8px 15px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 15px 30px rgba(0, 0, 0, 0.5);
            
            /* ESPACIADO */
            --space-xs: 0.5rem;
            --space-sm: 1rem;
            --space-md: 1.5rem;
            --space-lg: 2rem;
            --space-xl: 3rem;
            
            /* TIPOGRAFÍA */
            --font-primary: 'Space Grotesk', sans-serif;
            --font-secondary: 'Work Sans', sans-serif;
            --font-mono: 'Fira Code', monospace;
        }

        /* ============= BASE ============= */
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: var(--font-secondary);
            background: var(--bg-color);
            color: var(--text-light);
            line-height: 1.7;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 var(--space-lg);
        }
        
        /* ============= TIPOGRAFÍA ============= */
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-primary);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }
        
        h1 { font-size: clamp(2rem, 4vw, 2.8rem); }
        h2 { font-size: clamp(1.5rem, 3vw, 2rem); }
        h3 { font-size: clamp(1.2rem, 2.5vw, 1.6rem); }
        h4 { font-size: 1.1rem; }
        
        p {
            margin-bottom: var(--space-sm);
            color: var(--text-secondary);
        }
        
        a {
            color: var(--orange-primary);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        a:hover {
            color: var(--text-primary);
        }
        
        /* ============= HEADER ============= */
        .welcome-header {
            background: linear-gradient(135deg, var(--bg-color) 0%, var(--bg-secondary) 100%);
            border-bottom: 1px solid var(--border-color);
            padding: var(--space-xl) 0;
            text-align: center;
        }

        .welcome-title {
            color: var(--text-light);
            font-weight: 700;
            margin-bottom: var(--space-sm);
        }

        .welcome-subtitle {
            color: var(--text-medium);
            font-size: 1.2rem;
            margin-bottom: var(--space-lg);
            font-weight: 400;
        }

        .user-welcome {
            background: var(--orange-gradient);
            color: white;
            padding: var(--space-sm) var(--space-lg);
            border-radius: 50px;
            display: inline-block;
            font-weight: 600;
            font-size: 0.95rem;
            box-shadow: var(--shadow-sm);
        }

        /* ============= NAVEGACIÓN ============= */
        .nav-title {
            text-align: center;
            color: var(--text-light);
            margin: var(--space-xl) 0 var(--space-lg) 0;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .nav-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid var(--orange-primary);
        }

        .nav-item:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
            border-color: var(--orange-primary);
        }

        .nav-icon {
            font-size: 1.8rem;
            width: 40px;
            height: 40px;
            background: var(--orange-gradient);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            color: white;
        }

        .nav-info h3 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
            color: var(--text-light);
        }

        .nav-info p {
            font-size: 0.85rem;
            margin: 0;
            line-height: 1.4;
            color: var(--text-medium);
        }

        /* ============= SECCIONES ============= */
        .content-section {
            margin: var(--space-xl) 0;
        }

        .section-title {
            margin-bottom: var(--space-lg);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            color: var(--text-light);
        }

        .section-icon {
            font-size: 1.5rem;
            color: var(--orange-primary);
        }

        .section-description {
            text-align: center;
            max-width: 600px;
            margin: 0 auto var(--space-lg) auto;
            color: var(--text-medium);
        }

        .section-description strong {
            color: var(--text-light);
            font-weight: 600;
        }

        /* ============= TIMELINE PROFESIONAL (SIN TEXTO CORTADO) ============= */
        .etapas-container {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-accent) 100%);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: var(--space-xl) var(--space-lg);
            margin: var(--space-xl) auto;
            max-width: 1400px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: visible;
        }

        .etapas-container::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--orange-primary), transparent, var(--orange-primary));
            border-radius: 20px;
            z-index: -1;
            opacity: 0.1;
        }

        .etapas-header {
            text-align: center;
            font-family: var(--font-primary);
            font-size: clamp(2rem, 4vw, 2.5rem);
            color: var(--text-light);
            margin-bottom: var(--space-md);
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .etapas-subtitle {
            text-align: center;
            color: var(--text-medium);
            font-size: 1.2rem;
            margin-bottom: var(--space-xl);
            font-weight: 400;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* MEJORAS GENERALES DE VISIBILIDAD */
        .content-section {
            margin: calc(var(--space-xl) * 1.5) 0;
            scroll-margin-top: 100px;
        }

        .section-title {
            font-size: clamp(1.8rem, 3vw, 2.2rem);
            margin-bottom: var(--space-lg);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            color: var(--text-light);
            font-weight: 700;
        }

        .section-description {
            text-align: center;
            max-width: 700px;
            margin: 0 auto var(--space-xl) auto;
            color: var(--text-medium);
            font-size: 1.1rem;
            line-height: 1.7;
        }

        /* TIMELINE FLUJO CALOR - DISEÑO MEJORADO Y MÁS VISIBLE */
        .flujo-pipeline {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-lg);
            margin: var(--space-xl) 0;
            padding: var(--space-md);
        }

        .etapa {
            background: linear-gradient(135deg, var(--bg-color) 0%, var(--bg-secondary) 100%);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: var(--space-xl) var(--space-lg);
            text-align: center;
            position: relative;
            transition: all 0.4s ease;
            box-shadow: var(--shadow-md);
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .etapa:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(255, 107, 0, 0.2);
            border-color: var(--orange-primary);
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-accent) 100%);
        }

        .etapa-numero {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: var(--orange-gradient);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-primary);
            font-size: 1.4rem;
            font-weight: 700;
            box-shadow: 0 8px 20px rgba(255, 107, 0, 0.4);
            border: 4px solid var(--bg-color);
            z-index: 10;
        }

        .etapa-icon {
            font-size: 3rem;
            margin: var(--space-md) 0 var(--space-sm) 0;
            display: block;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .etapa h3 {
            font-family: var(--font-primary);
            font-size: 1.3rem;
            color: var(--text-light);
            margin: var(--space-sm) 0;
            font-weight: 700;
            line-height: 1.2;
        }

        .etapa p {
            color: var(--text-medium);
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
            font-weight: 500;
        }

        .etapa-detalle {
            margin-top: var(--space-sm);
            padding-top: var(--space-sm);
            border-top: 1px solid var(--border-color);
            font-size: 0.85rem;
            color: var(--text-muted);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .etapa:hover .etapa-detalle {
            opacity: 1;
        }

        /* LÍNEAS CONECTORAS MEJORADAS */
        .etapa::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -20px;
            width: 40px;
            height: 3px;
            background: linear-gradient(90deg, var(--orange-primary), transparent);
            transform: translateY(-50%);
            z-index: 1;
            border-radius: 2px;
        }

        .etapa:nth-child(5)::after,
        .etapa:last-child::after {
            display: none;
        }

        /* EFECTOS ESPECIALES PARA DESTACAR */
        .etapa[data-etapa="1"] {
            border-color: rgba(255, 107, 0, 0.3);
        }

        .etapa[data-etapa="1"]:hover {
            border-color: var(--orange-primary);
            box-shadow: 0 20px 40px rgba(255, 107, 0, 0.3);
        }

        /* RESPONSIVE MEJORADO */
        @media (max-width: 1200px) {
            .flujo-pipeline {
                grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
                gap: var(--space-md);
            }
            
            .etapa::after {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .flujo-pipeline {
                grid-template-columns: 1fr;
                gap: var(--space-xl);
                padding: var(--space-sm);
            }
            
            .etapa {
                min-height: 200px;
                padding: var(--space-lg);
            }
            
            .etapa-numero {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
                top: -18px;
            }
            
            .etapa-icon {
                font-size: 2.5rem;
            }
            
            .etapa h3 {
                font-size: 1.2rem;
            }
            
            .etapa p {
                font-size: 0.95rem;
            }
        }

        @media (max-width: 480px) {
            .etapa {
                padding: var(--space-md);
                min-height: 180px;
            }
            
            .etapa-icon {
                font-size: 2.2rem;
            }
            
            .etapa h3 {
                font-size: 1.1rem;
            }
        }

        /* ============= COMPONENTES ============= */
        .prompt-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin: var(--space-md) 0;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .prompt-header {
            background: linear-gradient(135deg, var(--bg-accent) 0%, var(--bg-secondary) 100%);
            padding: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .prompt-title {
            font-size: 1.1rem;
            margin-bottom: var(--space-xs);
            font-weight: 600;
            color: var(--text-light);
        }

        .prompt-description {
            font-size: 0.9rem;
            margin: 0;
            color: var(--text-medium);
        }

        .code-block {
            position: relative;
            background: #1a1a1a;
            color: #f8f8f2;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            padding: var(--space-md);
            overflow-x: auto;
            line-height: 1.5;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--orange-gradient);
            color: white;
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            transform: translateY(-1px);
        }

        .download-area, .highlight-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: var(--space-lg);
            margin: var(--space-md) 0;
            box-shadow: var(--shadow-sm);
        }

        .download-title {
            font-size: 1.1rem;
            margin-bottom: var(--space-xs);
            font-weight: 600;
            color: var(--text-light);
        }

        .download-description {
            margin-bottom: var(--space-md);
            font-size: 0.9rem;
            color: var(--text-medium);
        }

        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            background: var(--orange-gradient);
            color: white;
            padding: var(--space-sm) var(--space-md);
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .download-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .checklist {
            margin: var(--space-md) 0;
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
            transition: all 0.3s ease;
        }

        .checklist-item:hover {
            background: var(--bg-secondary);
            border-color: var(--orange-primary);
            transform: translateX(5px);
        }

        .checklist-checkbox {
            color: var(--orange-primary);
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            min-width: 16px;
        }

        .checklist-text strong {
            font-size: 0.9rem;
            display: block;
            margin-bottom: 0.2rem;
            font-weight: 600;
            color: var(--text-light);
        }

        .checklist-text small {
            font-size: 0.8rem;
            color: var(--text-medium);
        }

        .next-steps {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-accent) 100%);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: var(--space-xl);
            text-align: center;
            margin: var(--space-xl) 0;
            box-shadow: var(--shadow-md);
        }

        .next-steps h2 {
            color: var(--text-light);
        }

        .next-steps p {
            max-width: 600px;
            margin: 0 auto var(--space-md) auto;
            color: var(--text-medium);
        }

        .cta-implementation {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            background: var(--orange-gradient);
            color: white;
            padding: var(--space-md) var(--space-lg);
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
            margin: var(--space-md) 0;
        }

        .cta-implementation:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .simple-footer {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: var(--space-lg) 0;
            text-align: center;
            margin-top: var(--space-xl);
        }

        .simple-footer p {
            color: var(--text-medium);
            margin: 0;
            font-size: 0.9rem;
        }

        .simple-footer a {
            color: var(--orange-primary);
            text-decoration: none;
        }

        .simple-footer a:hover {
            color: var(--text-light);
        }

        .instruction-list {
            margin-left: var(--space-md);
        }

        .instruction-list li {
            margin-bottom: var(--space-sm);
            font-size: 0.9rem;
        }

        .instruction-list strong {
            font-weight: 600;
        }

        /* ============= RESPONSIVE ============= */
        @media (max-width: 768px) {
            .container {
                padding: 0 var(--space-md);
            }
            
            .nav-grid {
                grid-template-columns: 1fr;
            }
            
            .flujo-pipeline {
                padding-bottom: var(--space-md);
            }
        }
    </style>
    
    <link rel="icon" href="https://res.cloudinary.com/dfuya0vrl/image/upload/v1746402411/logo_sxdfzb.png" type="image/png">
</head>

<body>
<body class="contenido-page">
    <!-- Header minimalista -->
    <header class="welcome-header">
        <div class="container">
            <h1 class="welcome-title">🔥 Flujo de Calor Activado</h1>
            <p class="welcome-subtitle">Tu automatización está funcionando perfectamente</p>
            <div class="user-welcome">✅ Sistema operativo</div>
        </div>
    </header>

    <main class="contenido-principal">
        <div class="container">
            
            <!-- Navegación compacta -->
            <h2 class="nav-title">📋 Contenido del Flujo</h2>
                <div class="nav-grid">
                <a href="#timeline" class="nav-item">
                    <div class="nav-icon">⚡</div>
                        <div class="nav-info">
                        <h3>Timeline</h3>
                        <p>5 etapas compactas</p>
                        </div>
                    </a>
                    
                    <a href="#prompts" class="nav-item">
                        <div class="nav-icon">🤖</div>
                        <div class="nav-info">
                        <h3>Prompts IA</h3>
                        <p>3 prompts listos</p>
                        </div>
                    </a>
                    
                    <a href="#plantilla" class="nav-item">
                        <div class="nav-icon">⚙️</div>
                        <div class="nav-info">
                        <h3>Plantilla N8N</h3>
                        <p>Archivo completo</p>
                        </div>
                    </a>
                    
                <a href="#checklist" class="nav-item">
                        <div class="nav-icon">✅</div>
                        <div class="nav-info">
                        <h3>Checklist</h3>
                        <p>Pasos a seguir</p>
                        </div>
                    </a>
                </div>

            <!-- Timeline compacta -->
            <section id="timeline" class="content-section">
                <h2 class="section-title">
                    <span class="section-icon">⚡</span>
                    Timeline del Flujo de Calor
                </h2>
                
                <p class="section-description">
                    5 etapas automatizadas que transforman leads en oportunidades calificadas
                </p>
                
                <div class="etapas-container">
                    <h2 class="etapas-header">Las 5 Etapas del <span style="color: var(--orange-primary);">FLUJO CALOR</span></h2>
                    <p class="etapas-subtitle">El sistema que convierte leads fríos en citas calientes automáticamente</p>
                    
                    <div class="flujo-pipeline">
                        <div class="etapa" data-etapa="1">
                            <div class="etapa-numero">1</div>
                            <div class="etapa-icon">🎣</div>
                            <h3>Captura Inmediata</h3>
                            <p>Lead llega → Trigger en &lt;30 segundos</p>
                            <div class="etapa-detalle">
                                <strong>Tecnología:</strong> Webhooks, Cal.com<br>
                                <strong>Velocidad:</strong> Instantáneo
                            </div>
                        </div>
                        
                        <div class="etapa" data-etapa="2">
                            <div class="etapa-numero">2</div>
                            <div class="etapa-icon">🧠</div>
                            <h3>Análisis de IA</h3>
                            <p>Cualificación automática + scoring inteligente</p>
                            <div class="etapa-detalle">
                                <strong>IA:</strong> OpenAI GPT-4<br>
                                <strong>Output:</strong> Score 1-10 + categorización
                            </div>
                        </div>
                        
                        <div class="etapa" data-etapa="3">
                            <div class="etapa-numero">3</div>
                            <div class="etapa-icon">🚦</div>
                            <h3>Decisión Smart</h3>
                            <p>Segmentación automática por temperatura</p>
                            <div class="etapa-detalle">
                                <strong>Rutas:</strong> Caliente | Tibio | Frío<br>
                                <strong>Criterio:</strong> ICP + urgencia detectada
                            </div>
                        </div>
                        
                        <div class="etapa" data-etapa="4">
                            <div class="etapa-numero">4</div>
                            <div class="etapa-icon">⚡</div>
                            <h3>Acción Automática</h3>
                            <p>Respuesta personalizada + actualización CRM</p>
                            <div class="etapa-detalle">
                                <strong>Acciones:</strong> Email + Slack + CRM<br>
                                <strong>Personalización:</strong> 100% automática
                            </div>
                        </div>
                        
                        <div class="etapa" data-etapa="5">
                            <div class="etapa-numero">5</div>
                            <div class="etapa-icon">🎯</div>
                            <h3>Seguimiento Pro</h3>
                            <p>Nurturing continuo + recordatorios inteligentes</p>
                            <div class="etapa-detalle">
                                <strong>Funciones:</strong> Recordatorios + Analytics<br>
                                <strong>Duración:</strong> Hasta conversión
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Prompts de IA -->
            <section id="prompts" class="content-section">
                <h2 class="section-title">
                    <span class="section-icon">🤖</span>
                    Prompts de IA
                </h2>
                
                <p class="section-description">
                    3 prompts optimizados para análisis automático de leads
                </p>
                
                <!-- Prompt 1 -->
                <div class="prompt-container">
                    <div class="prompt-header">
                        <h3 class="prompt-title">Prompt 1: Cualificación y Puntuación</h3>
                        <p class="prompt-description">Analiza y puntúa leads automáticamente</p>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard('prompt1')">📋 Copiar</button>
<div id="prompt1">## ROL
Eres un Asistente de Ventas B2B experto en cualificar leads.

## TAREA
Analiza la información del lead y responde con JSON:
1. Puntuación de 1 a 10
2. Necesidad principal
3. Nombre de empresa
4. Resumen de 20 palabras

## INFORMACIÓN DEL LEAD:
    - Nombre: {{$json.body.payload.attendee.name}}
    - Email: {{$json.body.payload.attendee.email}}
    - Empresa: {{$json.body.payload.responses.company.value}}
    - Cargo: {{$json.body.payload.responses.role.value}}
- Necesidad: {{$json.body.payload.responses.need.value}}

## OUTPUT:
{
  "puntuacion_lead": <número_del_1_al_10>,
  "necesidad_principal": "<resumen_necesidad>",
  "nombre_empresa": "<empresa>",
  "resumen_slack": "<resumen_20_palabras>"
}</div>
                    </div>
                </div>
                
                <!-- Prompt 2 -->
                <div class="prompt-container">
                    <div class="prompt-header">
                        <h3 class="prompt-title">Prompt 2: Detección de Urgencia</h3>
                        <p class="prompt-description">Detecta nivel de urgencia del lead</p>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard('prompt2')">📋 Copiar</button>
<div id="prompt2">## ROL
Analista de ventas especializado en detectar urgencia de compra.

## TAREA
Analiza la descripción y clasifica urgencia. Busca palabras como "ahora", "urgente", "inmediato" vs "futuro", "explorando".

## INFORMACIÓN:
- Necesidad: {{$json.body.payload.responses.need.value}}

## OUTPUT:
{
  "nivel_urgencia": "<Alta|Media|Baja>",
  "señal_detectada": "<palabra_clave_justificativa>"
}</div>
                    </div>
                </div>
                
                <!-- Prompt 3 -->
                <div class="prompt-container">
                    <div class="prompt-header">
                        <h3 class="prompt-title">Prompt 3: Respuesta Personalizada</h3>
                        <p class="prompt-description">Genera respuesta automática personalizada</p>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyToClipboard('prompt3')">📋 Copiar</button>
<div id="prompt3">## ROL
Especialista en comunicación B2B que escribe emails personalizados.

## TAREA
Genera un email de respuesta automática personalizado basado en la información del lead.

## INFORMACIÓN:
- Nombre: {{$json.body.payload.attendee.name}}
    - Empresa: {{$json.body.payload.responses.company.value}}
- Necesidad: {{$json.body.payload.responses.need.value}}

## FORMATO:
Asunto: [Asunto personalizado]
---
[Email personalizado de 100-150 palabras]</div>
                </div>
            </section>

            <!-- Plantilla N8N -->
            <section id="plantilla" class="content-section">
                <h2 class="section-title">
                    <span class="section-icon">⚙️</span>
                    Plantilla N8N
                </h2>
                
                <p class="section-description">
                    Flujo completo listo para importar y personalizar
                </p>
                
                <div class="download-area">
                    <h3 class="download-title">🚀 Descarga los 4 Workflows Completos</h3>
                    <p class="download-description">Sistema FLUJO CALOR completo - 4 archivos .json listos para N8N</p>
                    <div style="background: var(--bg-accent); padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid var(--orange-primary);">
                        <h4 style="margin: 0 0 0.5rem 0; color: var(--text-light); font-size: 0.9rem;">📦 Incluye:</h4>
                        <ul style="margin: 0; padding-left: 1rem; color: var(--text-medium); font-size: 0.85rem;">
                            <li><strong>MOTOR-COMUNICACIONES-SCHEDULER:</strong> Sistema de recordatorios automatizados</li>
                            <li><strong>WORKFLOW-DEFINITIVO-OPTIMIZADO:</strong> Flujo principal optimizado</li>
                            <li><strong>WORKFLOW-NOTARIO-CAMBIOS-ESTADO:</strong> Control de cambios de estado</li>
                            <li><strong>WORKFLOW-SEGUIMIENTO-CICLO-CERRADO:</strong> Seguimiento completo</li>
                        </ul>
                    </div>
                    <a href="#" class="download-btn" onclick="downloadN8NTemplate()">
                        📥 Descargar 4 Workflows FLUJO CALOR
                    </a>
                </div>
                
                <div class="highlight-box">
                    <h4>⚠️ Importante:</h4>
                    <p>Esta plantilla requiere configuración personalizada:</p>
                    <ul class="instruction-list">
                        <li><strong>Configura credenciales API</strong> (OpenAI, CRM, Slack)</li>
                        <li><strong>Adapta prompts</strong> a tu negocio</li>
                        <li><strong>Conecta herramientas</strong> específicas</li>
                        <li><strong>Personaliza variables</strong> del flujo</li>
                    </ul>
                </div>
            </section>

            <!-- Checklist -->
            <section id="checklist" class="content-section">
                <h2 class="section-title">
                    <span class="section-icon">✅</span>
                    Checklist de Implementación
                </h2>
                
                <p class="section-description">
                    Pasos esenciales para implementar el flujo correctamente
                </p>
                
                <h3>Pre-Implementación</h3>
                <div class="checklist">
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>N8N instalado</strong>
                            <small>Instancia operativa con permisos de administrador</small>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>API Keys obtenidas</strong>
                            <small>OpenAI, CRM, Slack y email service</small>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Formulario configurado</strong>
                            <small>Cal.com o formulario web con campos necesarios</small>
                        </div>
                    </div>
                </div>
                
                <h3>Implementación</h3>
                <div class="checklist">
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Flujo importado</strong>
                            <small>Sin errores, todos los nodos visibles</small>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Credenciales configuradas</strong>
                            <small>Integraciones autenticadas correctamente</small>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Prompts personalizados</strong>
                            <small>Adaptados a tu ICP específico</small>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Pruebas completadas</strong>
                            <small>Test end-to-end con datos de ejemplo</small>
                        </div>
                    </div>
                </div>
                
                <h3>Post-Implementación</h3>
                <div class="checklist">
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Equipo entrenado</strong>
                            <small>Todo el equipo sabe usar las notificaciones</small>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox">☐</div>
                        <div class="checklist-text">
                            <strong>Métricas configuradas</strong>
                            <small>Tracking de conversión y ROI</small>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CTA Final -->
            <section class="next-steps">
                <h2>🚀 ¿Necesitas Implementación Profesional?</h2>
                <p>
                    Si quieres que implementemos y optimicemos todo el sistema por ti, 
                    <strong>agenda una consulta sin compromiso</strong>.
                </p>
                
                <a href="#" class="cta-implementation cal-popup-trigger"
                   data-cal-link="math-ai/reunion-inicial"
                   data-cal-namespace="reunion-inicial"
                   data-cal-config='{"layout":"month_view"}'>
                    🗓️ Agendar Consulta Gratuita
                </a>
                
                <p>45 minutos donde analizaremos tu proceso actual y diseñaremos una solución a medida.</p>
            </section>
        </div>
    </main>

    <!-- Footer simple -->
    <footer class="simple-footer">
        <div class="container">
            <p>© 2025 Math AI Agency • <a href="/">Volver al inicio</a></p>
        </div>
    </footer>

    <!-- Cal.com element-click embed code begins -->
    <script type="text/javascript">
      (function (C, A, L) { let p = function (a, ar) { a.q.push(ar); }; let d = C.document; C.Cal = C.Cal || function () { let cal = C.Cal; let ar = arguments; if (!cal.loaded) { cal.ns = {}; cal.q = cal.q || []; d.head.appendChild(d.createElement("script")).src = A; cal.loaded = true; } if (ar[0] === L) { const api = function () { p(api, arguments); }; const namespace = ar[1]; api.q = api.q || []; if(typeof namespace === "string"){cal.ns[namespace] = cal.ns[namespace] || api;p(cal.ns[namespace], ar);p(cal, ["initNamespace", namespace]);} else p(cal, ar); return;} p(cal, ar); }; })(window, "https://app.cal.com/embed/embed.js", "init");
      
      Cal("init", "reunion-inicial", {origin:"https://cal.com"});
    
      Cal.ns["reunion-inicial"]("ui", {"hideEventTypeDetails":false,"layout":"month_view"});
    </script>
    <!-- Cal.com element-click embed code ends -->

    <!-- Schema.org Structured Data for FLUJO CALOR Content -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": "FLUJO CALOR - Sistema de Automatización de Leads",
        "description": "Sistema completo que convierte leads fríos en citas calientes automáticamente en menos de 2 minutos usando N8N e IA",
        "brand": {
            "@type": "Organization",
            "name": "Math AI Agency"
        },
        "category": "Business Automation Software",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock",
            "priceValidUntil": "2025-12-31",
            "description": "Acceso gratuito al sistema FLUJO CALOR completo"
        },
        "includesObject": [
            {
                "@type": "SoftwareApplication",
                "name": "Plantilla N8N FLUJO CALOR",
                "applicationCategory": "Business Automation",
                "operatingSystem": "Web-based"
            },
            {
                "@type": "DigitalDocument",
                "name": "3 Prompts de IA Optimizados",
                "description": "Prompts específicos para cualificación, urgencia y análisis de ICP"
            },
            {
                "@type": "DigitalDocument", 
                "name": "Diagrama Estratégico Visual",
                "description": "Las 5 etapas del FLUJO CALOR paso a paso"
            },
            {
                "@type": "DigitalDocument",
                "name": "Checklist de Implementación",
                "description": "Guía paso a paso completa para implementar el sistema"
            }
        ],
        "audience": {
            "@type": "BusinessAudience",
            "audienceType": "PYME de servicios B2B"
        }
    }
    </script>

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "Cómo Implementar el Sistema FLUJO CALOR",
        "description": "Guía completa para implementar automatización de leads con respuesta en menos de 2 minutos",
        "image": "https://res.cloudinary.com/dfuya0vrl/image/upload/v1746402411/logo_sxdfzb.png",
        "totalTime": "PT2H",
        "estimatedCost": {
            "@type": "MonetaryAmount",
            "currency": "USD",
            "value": "0"
        },
        "supply": [
            {
                "@type": "HowToSupply",
                "name": "Cuenta N8N"
            },
            {
                "@type": "HowToSupply", 
                "name": "API Key OpenAI"
            },
            {
                "@type": "HowToSupply",
                "name": "CRM (HubSpot/Pipedrive)"
            }
        ],
        "step": [
            {
                "@type": "HowToStep",
                "name": "Pre-Implementación",
                "text": "Configurar N8N, obtener API Keys y preparar formulario web"
            },
            {
                "@type": "HowToStep",
                "name": "Importar Plantilla",
                "text": "Importar el archivo JSON en N8N y configurar credenciales"
            },
            {
                "@type": "HowToStep",
                "name": "Personalizar Prompts",
                "text": "Adaptar los prompts de IA a tu ICP específico"
            },
            {
                "@type": "HowToStep",
                "name": "Pruebas",
                "text": "Realizar pruebas end-to-end con datos de ejemplo"
            },
            {
                "@type": "HowToStep",
                "name": "Post-Implementación",
                "text": "Entrenar equipo, configurar métricas y documentar proceso"
            }
        ]
    }
    </script>

    <!-- CSS Loading Fallback -->
    <script>
        (function(){
            var links = document.querySelectorAll('link[rel="preload"][as="style"]');
            for (var i = 0; i < links.length; i++) {
                if (!links[i].onload) {
                    links[i].rel = 'stylesheet';
                }
            }
        })();
    </script>

    <script>
        // ====== FUNCIONALIDADES PROFESIONALES ======
        
        // Verificar acceso del usuario y personalizar experiencia
        function checkUserAccess() {
            const userData = localStorage.getItem('flujoCalorUser');
            if (userData) {
                const user = JSON.parse(userData);
                const welcomeElement = document.getElementById('userWelcome');
                if (welcomeElement && user.nombre) {
                    welcomeElement.innerHTML = `<span>¡Hola <strong>${user.nombre}</strong>! Aquí está todo lo que necesitas 👇</span>`;
                }
                
                // Track access con datos del usuario
                trackEvent('flujo_calor_content_access', {
                    user_name: user.nombre,
                    access_time: Date.now() - user.accessTime,
                    had_webhook_error: user.webhookError || false
                });
            }
        }
        
        // Función mejorada para copiar prompts al clipboard
        function copyToClipboard(promptId) {
            const promptText = document.getElementById(promptId).textContent;
            navigator.clipboard.writeText(promptText).then(function() {
                // Feedback visual mejorado
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '✅ ¡Copiado!';
                btn.style.background = 'var(--flujo-success)';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = 'var(--flujo-primary)';
                }, 2000);
                
                // Track copy action
                trackEvent('flujo_calor_prompt_copied', {
                    prompt_id: promptId,
                    prompt_length: promptText.length
                });
                
            }).catch(function() {
                // Fallback para navegadores que no soportan clipboard
                alert('Prompt copiado. Usa Ctrl+V para pegarlo en N8N.');
            });
        }
        
        // Función para descargar los 4 workflows completos del FLUJO CALOR
        async function downloadN8NTemplate() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '🔄 Descargando...';
            btn.disabled = true;

            // URLs de los 4 workflows del FLUJO CALOR
            const workflows = [
                {
                    url: 'https://minio.mathai.agency/12webmedia/Workflows%20flujo%20calor/MOTOR-COMUNICACIONES-SCHEDULER.json',
                    name: 'MOTOR-COMUNICACIONES-SCHEDULER.json',
                    description: 'Motor de comunicaciones con recordatorios automatizados'
                },
                {
                    url: 'https://minio.mathai.agency/12webmedia/Workflows%20flujo%20calor/WORKFLOW-DEFINITIVO-OPTIMIZADO.json',
                    name: 'WORKFLOW-DEFINITIVO-OPTIMIZADO.json',
                    description: 'Workflow principal del FLUJO CALOR optimizado'
                },
                {
                    url: 'https://minio.mathai.agency/12webmedia/Workflows%20flujo%20calor/WORKFLOW-NOTARIO-CAMBIOS-ESTADO.json',
                    name: 'WORKFLOW-NOTARIO-CAMBIOS-ESTADO.json',
                    description: 'Sistema notario para cambios de estado'
                },
                {
                    url: 'https://minio.mathai.agency/12webmedia/Workflows%20flujo%20calor/WORKFLOW-SEGUIMIENTO-CICLO-CERRADO.json',
                    name: 'WORKFLOW-SEGUIMIENTO-CICLO-CERRADO.json',
                    description: 'Seguimiento de ciclo cerrado completo'
                }
            ];

            try {
                let downloadedCount = 0;
                const totalFiles = workflows.length;

                for (const workflow of workflows) {
                    try {
                        // Actualizar progreso
                        btn.textContent = `📥 Descargando ${downloadedCount + 1}/${totalFiles}...`;
                        
                        // Descargar archivo usando fetch
                        const response = await fetch(workflow.url);
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        const blob = await response.blob();
                        
                        // Crear URL del blob y descargar
                        const blobUrl = window.URL.createObjectURL(blob);
                        const downloadLink = document.createElement('a');
                        downloadLink.href = blobUrl;
                        downloadLink.download = workflow.name;
                        downloadLink.style.display = 'none';
                        
                        // Agregar al DOM, hacer click y remover
                        document.body.appendChild(downloadLink);
                        downloadLink.click();
                        document.body.removeChild(downloadLink);
                        
                        // Limpiar URL del blob
                        window.URL.revokeObjectURL(blobUrl);
                        
                        downloadedCount++;
                        
                        // Pequeña pausa entre descargas
                        await new Promise(resolve => setTimeout(resolve, 800));
                        
                    } catch (error) {
                        console.error(`Error descargando ${workflow.name}:`, error);
                        // Intentar fallback con enlace directo
                        try {
                            const fallbackLink = document.createElement('a');
                            fallbackLink.href = workflow.url;
                            fallbackLink.download = workflow.name;
                            fallbackLink.target = '_blank';
                            fallbackLink.style.display = 'none';
                            document.body.appendChild(fallbackLink);
                            fallbackLink.click();
                            document.body.removeChild(fallbackLink);
                            downloadedCount++;
                        } catch (fallbackError) {
                            console.error(`Fallback también falló para ${workflow.name}:`, fallbackError);
                        }
                    }
                }

                // Track download exitoso
                trackEvent('flujo_calor_workflows_download', {
                    total_workflows: totalFiles,
                    downloaded_workflows: downloadedCount,
                    download_timestamp: Date.now(),
                    download_method: 'fetch_blob'
                });

                // Mostrar éxito
                showDownloadSuccess(downloadedCount);
                
            } catch (error) {
                console.error('Error general en descarga de workflows:', error);
                
                // Fallback: mostrar enlaces directos
                showDownloadFallback(workflows);
                
                trackEvent('flujo_calor_download_error', {
                    error_message: error.message,
                    fallback_used: true
                });
            } finally {
                // Restaurar botón
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                }, 2000);
            }
        }

        // Función fallback para mostrar enlaces directos
        function showDownloadFallback(workflows) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            const content = document.createElement('div');
            content.style.cssText = `
                background: var(--bg-secondary);
                border: 2px solid var(--border-color);
                border-radius: 16px;
                padding: 2rem;
                max-width: 600px;
                width: 90%;
                color: var(--text-light);
            `;

            content.innerHTML = `
                <h3 style="color: var(--orange-primary); margin-bottom: 1rem;">📥 Descargar Workflows FLUJO CALOR</h3>
                <p style="margin-bottom: 1.5rem; color: var(--text-medium);">Haz clic en cada enlace para descargar los workflows:</p>
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    ${workflows.map(workflow => `
                        <a href="${workflow.url}" 
                           download="${workflow.name}"
                           target="_blank"
                           style="
                               background: var(--orange-gradient);
                               color: white;
                               padding: 1rem;
                               border-radius: 8px;
                               text-decoration: none;
                               display: flex;
                               align-items: center;
                               gap: 0.5rem;
                               transition: transform 0.2s ease;
                           "
                           onmouseover="this.style.transform='translateY(-2px)'"
                           onmouseout="this.style.transform='translateY(0)'">
                            <span>📄</span>
                            <div>
                                <div style="font-weight: 600;">${workflow.name}</div>
                                <div style="font-size: 0.85rem; opacity: 0.9;">${workflow.description}</div>
                            </div>
                        </a>
                    `).join('')}
                </div>
                <button onclick="this.parentElement.parentElement.remove()" 
                        style="
                            background: var(--border-color);
                            color: var(--text-light);
                            border: none;
                            padding: 0.75rem 1.5rem;
                            border-radius: 6px;
                            margin-top: 1.5rem;
                            cursor: pointer;
                            width: 100%;
                        ">
                    Cerrar
                </button>
            `;

            modal.appendChild(content);
            document.body.appendChild(modal);

            // Cerrar con click fuera
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }
        
        // Función para mostrar éxito en descarga
        function showDownloadSuccess(count = 4) {
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #10B981, #059669);
                color: white;
                padding: 1.5rem 2rem;
                border-radius: 12px;
                box-shadow: 0 15px 35px rgba(16, 185, 129, 0.3);
                z-index: 1000;
                animation: slideInRight 0.5s ease, fadeOut 0.5s ease 3.5s forwards;
                border: 1px solid rgba(255, 255, 255, 0.2);
            `;
            successDiv.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.75rem;">
                    <span style="font-size: 1.5rem;">🎉</span>
                    <div>
                        <div style="font-weight: 700; font-size: 1rem;">¡Descarga Exitosa!</div>
                        <div style="font-size: 0.85rem; opacity: 0.9;">${count} workflows FLUJO CALOR descargados</div>
                    </div>
                </div>
            `;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (document.body.contains(successDiv)) {
                    document.body.removeChild(successDiv);
                }
            }, 4000);
        }
        
        // Smooth scroll mejorado para navegación
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Track navigation
                    trackEvent('flujo_calor_section_navigation', {
                        section: this.getAttribute('href'),
                        section_name: target.querySelector('.section-title')?.textContent || 'unknown'
                    });
                }
            });
        });
        
        // Checklist interactivo mejorado
        document.querySelectorAll('.checklist-checkbox').forEach(checkbox => {
            checkbox.addEventListener('click', function() {
                const isChecked = this.textContent === '✅';
                if (!isChecked) {
                    this.textContent = '✅';
                    this.style.background = 'var(--flujo-success)';
                    this.style.color = 'white';
                    this.style.borderColor = 'var(--flujo-success)';
                    
                    // Efecto de confetti mini
                    createMiniConfetti(this);
                } else {
                    this.textContent = '☐';
                    this.style.background = 'transparent';
                    this.style.color = 'var(--flujo-primary)';
                    this.style.borderColor = 'var(--flujo-primary)';
                }
                
                // Track checklist progress
                const totalItems = document.querySelectorAll('.checklist-checkbox').length;
                const checkedItems = document.querySelectorAll('.checklist-checkbox:contains("✅")').length;
                const progress = Math.round((checkedItems / totalItems) * 100);
                
                trackEvent('flujo_calor_checklist_progress', {
                    progress_percentage: progress,
                    total_items: totalItems,
                    checked_items: checkedItems
                });
            });
        });
        
        // Mini confetti para checklist
        function createMiniConfetti(element) {
            const colors = ['#FF4500', '#FF6B35', '#F7931E'];
            const rect = element.getBoundingClientRect();
            
            for (let i = 0; i < 5; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    width: 4px;
                    height: 4px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 1000;
                    left: ${rect.left + rect.width/2}px;
                    top: ${rect.top + rect.height/2}px;
                `;
                
                document.body.appendChild(particle);
                
                const angle = (Math.PI * 2 * i) / 5;
                const velocity = 30;
                const vx = Math.cos(angle) * velocity;
                const vy = Math.sin(angle) * velocity;
                
                let x = 0, y = 0, opacity = 1;
                
                const animate = () => {
                    x += vx * 0.1;
                    y += vy * 0.1;
                    opacity -= 0.05;
                    
                    particle.style.transform = `translate(${x}px, ${y}px)`;
                    particle.style.opacity = opacity;
                    
                    if (opacity > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        document.body.removeChild(particle);
                    }
                };
                
                requestAnimationFrame(animate);
            }
        }
        
        // Analytics tracking mejorado
        function trackEvent(eventName, parameters = {}) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, {
                    event_category: 'flujo_calor_content',
                    page_title: 'FLUJO CALOR - Contenido Completo',
                    timestamp: new Date().toISOString(),
                    ...parameters
                });
            }
            console.log('📊 FLUJO CALOR Content Event:', eventName, parameters);
        }
        
        // Scroll tracking avanzado
        let scrollMilestones = {25: false, 50: false, 75: false, 90: false};
        let maxScroll = 0;
        
        window.addEventListener('scroll', () => {
            const scrollPercent = Math.round((window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100);
            maxScroll = Math.max(maxScroll, scrollPercent);
            
            Object.keys(scrollMilestones).forEach(milestone => {
                if (scrollPercent >= milestone && !scrollMilestones[milestone]) {
                    scrollMilestones[milestone] = true;
                    trackEvent('flujo_calor_content_scroll', {
                        scroll_depth: milestone,
                        max_scroll: maxScroll
                    });
                }
            });
        });
        
        // Tiempo en página y engagement
        let engagementStartTime = Date.now();
        let totalTimeOnPage = 0;
        let isVisible = true;
        
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && isVisible) {
                totalTimeOnPage += Date.now() - engagementStartTime;
                isVisible = false;
                
                trackEvent('flujo_calor_content_visibility_hidden', {
                    session_time: totalTimeOnPage,
                    max_scroll_reached: maxScroll
                });
            } else if (!document.hidden && !isVisible) {
                engagementStartTime = Date.now();
                isVisible = true;
            }
        });
        
        // Tracking para botones de Calendly
        function initCalendarTracking() {
            document.querySelectorAll('.cal-popup-trigger').forEach(function(button) {
                button.addEventListener('click', function() {
                    const buttonText = this.textContent.trim();
                    trackEvent('flujo_calor_calendar_click', {
                        button_text: buttonText,
                        page_section: 'content_page_cta'
                    });
                });
            });
        }

        // Inicialización mejorada
        document.addEventListener('DOMContentLoaded', function() {
            checkUserAccess();
            initCalendarTracking();
            
            // Track page view con contexto
            trackEvent('flujo_calor_content_page_view', {
                referrer: document.referrer,
                user_agent: navigator.userAgent,
                screen_resolution: `${screen.width}x${screen.height}`,
                viewport_size: `${window.innerWidth}x${window.innerHeight}`,
                has_user_data: !!localStorage.getItem('flujoCalorUser')
            });
            
            // Añadir animaciones CSS necesarias
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                
                @keyframes fadeOut {
                    to { opacity: 0; transform: translateX(100%); }
                }
            `;
            document.head.appendChild(style);
            
            console.log('✅ FLUJO CALOR Content Page Ready - Professional Version');
        });
    </script>
</body>
</html> 